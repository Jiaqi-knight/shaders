<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Shaders - How Do They Work?</title>

		<meta name="description" content="A high-level introduction to vertex and fragment shaders via concrete WebGL examples.">
		<meta name="author" content="Evan Todd">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="reveal.js/css/reveal.min.css">
		<link rel="stylesheet" href="presentation/style.css" id="theme">

		<script src="presentation/jquery.min.js"></script>
		<script src="samples/three.min.js"></script>

		<!--[if lt IE 9]>
		<script src="reveal.js/lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<h1>shaders</h1>
					<h3>how do they work?</h3>
					<small>
						evan todd
						| <a href="http://et1337.com">et1337.com</a>
						| <a href="http://twitter.com/et1337">@et1337</a>
					</small>
					<br />
					&#8592;&#8593;&#8595;&#8594;
				</section>
				<section>
					<h3>talk at me if you're into</h3>
					<ul>
						<li>event-driven servers</li>
						<li>deployment automation</li>
						<li>private clouds</li>
						<li>deferred rendering</li>
						<li>standing desks</li>
						<li>oculus rift</li>
						<li>graphic design</li>
						<li>indie games</li>
					</ul>
					<ul>
						<li>opengl es</li>
						<li>python</li>
						<li>html5</li>
						<li>vim</li>
						<li>c#</li>
						<li>minimalist running</li>
						<li>shaders... duh</li>
						<li>or you know, anything else</li>
					</ul>
				</section>
				<section>
					<h3>how do i graphics?</h3>
					a crash course
				</section>
				<section>
					<h3>frame buffer</h3>
					the screen is a buffer of 24-bit numbers<br />
					each pixel consists of three 8-bit values ranging 0-255
					<table>
						<tr><td>red</td><td><input type="text" class="rgb r" size="3" maxlength="3" value="0" /></td></tr>
						<tr><td>green</td><td><input type="text" class="rgb g" size="3" maxlength="3" value="255" /></td></tr>
						<tr><td>blue</td><td><input type="text" class="rgb b" size="3" maxlength="3" value="255" /></td></tr>
					</table>
					<div id="color-swatch" style="background-color: #0ff;">
					</div>
				</section>
				<section>
					<h3>screen-space coordinates</h3>
					<img src="presentation/screen-space-coords.svg" />
				</section>
				<section>
					<h3>immediate mode draw loop</h3>
					<img src="presentation/draw-loop.svg" />
				</section>
				<section>
					<section>
						<pre><code data-trim class="javascript">
while (true)
{     
	// *snip* - other things like processing window events

	glClearColor(1.0f, 1.0f, 1.0f); // what color?
	glClear(GL_COLOR_BUFFER_BIT); // clear screen

	glColor3f(0.0f, 0.0f, 1.0f); // what color?
	glPointSize(10.0f);

	glBegin(GL_POINTS);
	glVertex3f(0.0f, 0.8f, 0.0f);
	glVertex3f(-0.8f, -0.8f, 0.0f);
	glVertex3f(0.8f, -0.8f, 0.0f);
	glEnd();

	glutSwapBuffers(); // actually display it
}
						</code></pre>
						<a href="#" class="navigate-down"><img src="presentation/arrow.svg" /></a>
					</section>
					<section>
						<img src="presentation/immediate-mode.svg" />
					</section>
				</section>
				<section>
					<h3>vbo draw loop</h3>
					<img src="presentation/vbo-draw-loop.svg" />
				</section>
				<section>
					<h3>webgl!</h3>
				</section>
				<section>
					<section>
						<pre><code data-trim data-src="samples/triangle.js" class="javascript"></code></pre>
						<a href="#" class="navigate-down"><img src="presentation/arrow.svg" /></a>
					</section>
					<section>
						<iframe data-src="samples/viewer.html?js=triangle.js"></iframe>
					</section>
				</section>
				<section>
					<h3>matrices</h3>
					<table id="matrixa" class="matrix">
						<tr>
							<td><input type="text" size="3" value="1" /></td>
							<td><input type="text" size="3" value="0" /></td>
							<td><input type="text" size="3" value="0" /></td>
							<td><input type="text" size="3" value="0" /></td>
							<td>*</td>
							<td><input type="text" size="3" value="1" /></td>
							<td>=</td>
							<td class="result">1</td>
						</tr>
						<tr>
							<td><input type="text" size="3" value="0" /></td>
							<td><input type="text" size="3" value="1" /></td>
							<td><input type="text" size="3" value="0" /></td>
							<td><input type="text" size="3" value="0" /></td>
							<td></td>
							<td><input type="text" size="3" value="1" /></td>
							<td></td>
							<td class="result">1</td>
						</tr>
						<tr>
							<td><input type="text" size="3" value="0" /></td>
							<td><input type="text" size="3" value="0" /></td>
							<td><input type="text" size="3" value="1" /></td>
							<td><input type="text" size="3" value="0" /></td>
							<td></td>
							<td><input type="text" size="3" value="1" /></td>
							<td></td>
							<td class="result">1</td>
						</tr>
						<tr>
							<td><input type="text" size="3" value="0" /></td>
							<td><input type="text" size="3" value="0" /></td>
							<td><input type="text" size="3" value="0" /></td>
							<td><input type="text" size="3" value="1" /></td>
							<td></td>
							<td><input type="text" size="3" value="1" /></td>
							<td></td>
							<td class="result">1</td>
						</tr>
					</table>
				</section>
				<section>
					<table id="matrixb" class="matrix">
						<tr>
							<td><input type="text" size="3" value="1" /></td>
							<td><input type="text" size="3" value="0" /></td>
							<td><input type="text" size="3" value="0" /></td>
							<td><input type="text" size="3" value="0" /></td>
						</tr>
						<tr>
							<td><input type="text" size="3" value="0" /></td>
							<td><input type="text" size="3" value="1" /></td>
							<td><input type="text" size="3" value="0" /></td>
							<td><input type="text" size="3" value="0" /></td>
						</tr>
						<tr>
							<td><input type="text" size="3" value="0" /></td>
							<td><input type="text" size="3" value="0" /></td>
							<td><input type="text" size="3" value="1" /></td>
							<td><input type="text" size="3" value="0" /></td>
						</tr>
						<tr>
							<td><input type="text" size="3" value="0" /></td>
							<td><input type="text" size="3" value="0" /></td>
							<td><input type="text" size="3" value="0" /></td>
							<td><input type="text" size="3" value="1" /></td>
						</tr>
					</table>
					<iframe id="matrix-sample" data-src="samples/viewer.html?js=matrix.js"></iframe>
				</section>
				<section>
					<section>
						<h3>perspective</h3>
						<pre><code data-trim class="javascript">
var camera = new THREE.PerspectiveCamera
(
	45, // field of view (degrees)
	window.innerWidth / window.innerHeight, // aspect ratio
	1, // near plane
	1000 // far plane
);
camera.position.z = 500;

var geometry = new THREE.Geometry();

// cube!
geometry.vertices.push(new THREE.Vector3(-80, -80, -80));
geometry.vertices.push(new THREE.Vector3(-80, 80, -80));
geometry.vertices.push(new THREE.Vector3(80, -80, -80));
geometry.vertices.push(new THREE.Vector3(80, 80, -80));
geometry.vertices.push(new THREE.Vector3(-80, -80, 80));
geometry.vertices.push(new THREE.Vector3(-80, 80, 80));
geometry.vertices.push(new THREE.Vector3(80, -80, 80));
geometry.vertices.push(new THREE.Vector3(80, 80, 80));
						</code></pre>
						<a href="#" class="navigate-down"><img src="presentation/arrow.svg" /></a>
					</section>
					<section>
						<table id="matrixc" class="matrix">
							<tr>
								<td><input type="text" size="3" value="1" /></td>
								<td><input type="text" size="3" value="0" /></td>
								<td><input type="text" size="3" value="0" /></td>
								<td><input type="text" size="3" value="0" /></td>
							</tr>
							<tr>
								<td><input type="text" size="3" value="0" /></td>
								<td><input type="text" size="3" value="1" /></td>
								<td><input type="text" size="3" value="0" /></td>
								<td><input type="text" size="3" value="0" /></td>
							</tr>
							<tr>
								<td><input type="text" size="3" value="0" /></td>
								<td><input type="text" size="3" value="0" /></td>
								<td><input type="text" size="3" value="1" /></td>
								<td><input type="text" size="3" value="0" /></td>
							</tr>
							<tr>
								<td><input type="text" size="3" value="0" /></td>
								<td><input type="text" size="3" value="0" /></td>
								<td><input type="text" size="3" value="0" /></td>
								<td><input type="text" size="3" value="1" /></td>
							</tr>
						</table>
						<iframe id="matrix-sample2" data-src="samples/viewer.html?js=perspective.js"></iframe>
					</section>
				</section>
				<section>
					<h3>what if we want to do something more complicated?</h3>
					<ul>
						<li>so far we have been using the "fixed function pipeline"</li>
						<li>the gpu can only do matrix multiplication</li>
						<li>if we want to move individual vertices, we have to update the vbo</li>
					</ul>
				</section>
				<section>
					<h3>baby's first vertex shader</h3>
					<pre><code data-trim class="glsl">
&lt;script type="x-shader/x-vertex" id="vs"&gt;
	void main()
	{
		gl_PointSize = 2.0;
		gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1);
	}
&lt;/script&gt;
					</code></pre>
				</section>
				<section>
					<section>
						<h3>three.js setup</h3>
						<pre><code data-trim class="javascript">
var material = new THREE.ShaderMaterial(
{
	vertexShader: document.getElementById('vs').textContent,
	color: 0xff0000,
});
						</code></pre>
						<a href="#" class="navigate-down"><img src="presentation/arrow.svg" /></a>
					</section>
					<section>
						<iframe data-src="samples/viewer.html?js=vs.js&vs=basic.vs"></iframe>
					</section>
				</section>
				<section>
					<section>
						<h3>let's make an ocean</h3>
						<p>start with a flat plane</p>
						<pre><code data-trim class="javascript">
var geometry = new THREE.Geometry();
for (var x = -50; x &lt; 50; x++)
{
	for (var z = -50; z &lt; 50; z++)
		geometry.vertices.push(new THREE.Vector3(x, 0, z));
}
						</code></pre>
						<a href="#" class="navigate-down"><img src="presentation/arrow.svg" /></a>
					</section>
					<section>
						<iframe data-src="samples/viewer.html?js=ocean1.js&vs=basic.vs"></iframe>
					</section>
				</section>
				<section>
					<h3>ocean animation</h3>
					<ul>
						<li>shaders are basically stateless</li>
						<li>pass in the same input, you always get the same output</li>
						<li>how can we make the output change over time?</li>
					</ul>
				</section>
				<section>
					<h3>uniforms</h3>
					<ul>
						<li>so named because they do not change from vertex to vertex</li>
						<li>we will pass one float (time) from Javascript into the shader</li>
						<li>every vertex will have access to this value</li>
					</ul>
				</section>
				<section>
					<pre><code data-trim class="javascript">
var uniforms =
{
	time: { type: 'f', value: 0 }, // f for float
};

var material = new THREE.ShaderMaterial(
{
	vertexShader: document.getElementById('vs').textContent,
	color: 0xff0000,
	uniforms: uniforms,
});

// snip...
var clock = new THREE.Clock();
function render()
{
	requestAnimationFrame(render);
	uniforms.time.value = clock.getElapsedTime();
	renderer.render(scene, camera);
}
render();
					</code></pre>
				</section>
				<section>
					<section>
						<h3>and the vertex shader</h3>
						<pre><code data-trim data-src="samples/ocean2.vs" class="glsl"></code></pre>
						<a href="#" class="navigate-down"><img src="presentation/arrow.svg" /></a>
					</section>
					<section>
						<iframe data-src="samples/viewer.html?js=ocean2.js&vs=ocean2.vs"></iframe>
					</section>
				</section>
				<section>
					<h3>attributes</h3>
					<p>data attached to each vertex</p>
					<pre><code data-trim class="javascript">
var attributes =
{
	offset: { type: 'f', value: [] },
};

var geometry = new THREE.Geometry();
for (var x = -50; x &lt; 50; x++)
{
	for (var z = -50; z &lt; 50; z++)
	{
		geometry.vertices.push(new THREE.Vector3(x, 0, z));
		attributes.offset.value.push((x + z) * 0.1);
	}
}

var material = new THREE.ShaderMaterial(
{
	vertexShader: document.getElementById('vs').textContent,
	color: 0xff0000,
	uniforms: uniforms,
	attributes: attributes,
});
					</code></pre>
				</section>
				<section>
					<section>
						<h3>and the vertex shader</h3>
						<pre><code data-trim data-src="samples/ocean3.vs" class="glsl"></code></pre>
						<a href="#" class="navigate-down"><img src="presentation/arrow.svg" /></a>
					</section>
					<section>
						<iframe data-src="samples/viewer.html?js=ocean3.js&vs=ocean3.vs"></iframe>
					</section>
				</section>
				<section>
					<h3>fin</h3>
					<a href="https://github.com/et1337/shaders">https://github.com/et1337/shaders</a>
				</section>
			</div>
		</div>

		<script src="reveal.js/lib/js/head.min.js"></script>
		<script src="reveal.js/js/reveal.min.js"></script>

		<script src="presentation/index.js"></script>
	</body>
</html>
